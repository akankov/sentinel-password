import type { Validator, ValidatorOptions } from '../types'

/**
 * Bloom filter for top 10,000 common passwords
 * Sourced from SecLists: https://github.com/danielmiessler/SecLists
 *
 * Uses a Bloom filter for space-efficient storage
 */

// Bloom filter parameters
const BLOOM_SIZE: number = 120000
const BLOOM_HASH_COUNT: number = 8

// Pre-computed bloom filter buckets
const BLOOM_BUCKETS: Int32Array = new Int32Array([
  291755246, 3930666415, 4034332364, 3860922112, 2235512438, 1905551694, 4171467593, 2715998388,
  213061202, 3229549376, 1372229810, 1298185731, 143842074, 3690412857, 3987379655, 2280230654,
  3633956440, 602481289, 904181792, 2560943808, 200098971, 2594138605, 2729232207, 1320994160,
  2749170182, 3007619474, 3703235796, 1122300832, 3883418267, 3187147104, 2613337632, 1010620353,
  3467231455, 2804526130, 1894194945, 283089186, 1108822089, 2411663660, 595472674, 2891866068,
  208454385, 1689951788, 3376654475, 2601572256, 2030411937, 2673101211, 922654646, 2258996416,
  273862875, 790475168, 2687284153, 2072573401, 573001605, 3648685891, 1367279259, 209765976,
  443430837, 66061870, 4060190689, 737631638, 1304606708, 1330572993, 2445949080, 345493441,
  1858232514, 583279678, 1897086611, 1008251771, 365100160, 3916783446, 2633040400, 3959603201,
  197354922, 1590817385, 1962388923, 4013823459, 3144728300, 2693008789, 1538954794, 1049091806,
  2528659278, 2187237069, 3880578728, 968938041, 2008016459, 963903961, 4241569030, 795887231,
  205559595, 936643524, 1687843225, 1764681412, 2294267224, 421542045, 3606354216, 370937110,
  951132183, 2046954815, 1472610539, 3022124141, 2605041638, 3142970487, 229601992, 1020993955,
  3389888797, 2788617147, 3087007985, 96719360, 371876620, 770788624, 3045435438, 2806843285,
  613571509, 3909978247, 1268219925, 463995114, 1318026154, 4050433409, 3992331654, 886065353,
  871760344, 3950178495, 254429228, 3430270146, 3430639936, 781782466, 2486676476, 1373198666,
  3382140506, 2954578900, 1571669436, 2961988695, 3491771350, 2921413930, 2565194625, 3222032671,
  973594181, 124799336, 1106380002, 726452410, 3322105770, 2219444474, 796003869, 1001219990,
  1596314185, 3068193421, 682077759, 2010499495, 3940294920, 2380276264, 206002397, 1933643842,
  2045919698, 1921132808, 715531811, 652357097, 1623516470, 502780538, 2999643149, 621246004,
  1276855736, 1481162236, 3396588982, 559798293, 2169885364, 2013312152, 1411578318, 3708434975,
  265384857, 791027867, 2101128800, 346794659, 3952929819, 156559624, 1664988794, 702329700,
  3900716397, 1717357306, 2628538519, 1907074530, 1021509395, 3771501577, 1890383398, 218885848,
  2961285651, 2698524497, 532618279, 12720564, 2717615808, 3608411015, 1276378384, 307698448,
  629384399, 1325345420, 3924536928, 2637549116, 3478189662, 497880174, 3632732248, 2972900185,
  2527092941, 1372992683, 4008006148, 1265815196, 1216969938, 1840687041, 47203673, 2963148278,
  3237656634, 1391637506, 3471647921, 2375890924, 1170691871, 1211628509, 311923448, 3242593482,
  4096579220, 568712901, 1565124775, 227731489, 2100973911, 2610404042, 4283873181, 983502389,
  1712040698, 1511024816, 2656858175, 611175929, 3809126543, 1279688254, 1872422775, 3564069676,
  1904173162, 1783027580, 2115018800, 33462820, 415194960, 2853736993, 2915736292, 752224563,
  1532685972, 3691356881, 105607481, 813788775, 2992509611, 2795879275, 2136940620, 2190491351,
  282115766, 585219744, 1400768548, 133491181, 3150068772, 2534498459, 468037515, 1572205395,
  1222799404, 1351011222, 3730325215, 3900506178, 1464495455, 4027086227, 3880873575, 1619722985,
  2223316744, 3071606592, 3404283615, 206287291, 3135644042, 2717203886, 2375548036, 4115719763,
  3320037864, 887866417, 909715994, 3924540454, 2616915145, 3887895659, 3079442057, 3617199057,
  2752186390, 2010616516, 1717785368, 1724703640, 1236723009, 667331850, 496376351, 1212283522,
  297699866, 1648918777, 420962924, 676766994, 886911245, 1482214087, 3264005585, 1218521766,
  3917215769, 2739882010, 4143597827, 1970901259, 3327996724, 3760930490, 1057345315, 2264823467,
  3714722369, 2459994547, 1806041778, 2103968527, 2341167449, 1103502013, 2106360149, 2712251662,
  615580801, 3169561164, 1219614721, 2748025834, 1320149764, 2490080418, 3271743234, 2369295031,
  4093150064, 3912902125, 4258934173, 2653381045, 2145772068, 1688453062, 3204581341, 1078873617,
  2723378292, 3037554781, 636757773, 4027708075, 2542608685, 3788255910, 24680143, 3712101063,
  801681902, 4148940901, 826432459, 1251492396, 2780637719, 302657802, 4013749836, 4226011735,
  4104152454, 2415533413, 4004806788, 325876742, 829985797, 3603641655, 4161208830, 743976929,
  1571651168, 4158843309, 865135028, 2593501652, 182680980, 1625033010, 2340034339, 3240518928,
  1734122590, 394965578, 410919395, 43461903, 1107722720, 2104844175, 261627072, 3329560931,
  1809263658, 1175397701, 1288008519, 3377025494, 123186162, 1339977973, 3139215458, 1033730487,
  3430850606, 2127618248, 2448237639, 3683640348, 273732432, 115885828, 2888123157, 3196659162,
  3104498337, 454216842, 1811065622, 2822477056, 1913076960, 3614311664, 3548284610, 2620211438,
  3426207066, 3932427209, 3951879168, 3404158594, 344089828, 3335363681, 3050388789, 3043876905,
  2183668246, 1555451105, 2057991583, 516514039, 151592093, 3450252296, 2467345758, 1111349797,
  1381767003, 2354153215, 2884789575, 30685548, 4083174762, 195191096, 756660727, 3453946975,
  2589737366, 2286483805, 2525328431, 3978139268, 1161580737, 2580597294, 470418969, 1570727792,
  432176134, 1680598313, 2660700819, 396102320, 441621336, 4047931480, 3185616985, 1568878823,
  832449756, 1311239873, 2558242932, 324992982, 2418181950, 926390272, 2547919943, 155607892,
  4116627046, 728740051, 4079335808, 1983163227, 3936703851, 810553440, 1565619110, 3375628367,
  2499014517, 4005919538, 4125539206, 4068007814, 2536391235, 3969859943, 430533377, 3811921045,
  3897736002, 237861177, 221941864, 2366890026, 1287284452, 2821261737, 4140471936, 410336186,
  2774690374, 1187672311, 566497313, 1479490309, 1407996295, 983087451, 4077412389, 3126425695,
  4024536536, 3387780300, 420265888, 1091747585, 3359511375, 1826467582, 1574605183, 3528391322,
  1426973021, 520117870, 499297165, 243587171, 2911227669, 222326976, 1983582187, 1302390013,
  1190550330, 3001407513, 4054095745, 296911558, 977897242, 1492044979, 900815230, 1141367569,
  4045308260, 1694890659, 73020554, 2476654150, 503421552, 643780124, 1008535777, 898927067,
  1694514320, 2860898222, 2374492666, 70304923, 3976816739, 3256943330, 106169965, 188307646,
  46240278, 676822930, 70257133, 1461793351, 4249082603, 4252439046, 1112954228, 2503220662,
  153609230, 3003980232, 46550184, 2743788597, 1836522652, 500969492, 2989868342, 65497598,
  2406926108, 1218090526, 385471387, 2889448031, 40065020, 341621843, 424844219, 1779528617,
  1669398920, 1184025119, 4255962079, 1379820918, 3557825449, 1414364467, 3127679074, 1617839945,
  367116829, 4283023800, 1908658304, 3170047150, 1665065333, 4018763917, 3427202533, 3053922264,
  536918489, 422516926, 992438662, 3072522780, 612117713, 2917508206, 3968794344, 3971424115,
  1904710822, 4122600152, 2579554889, 3559328472, 1081228518, 1562657401, 1785360008, 3117455911,
  2812786714, 3096529732, 333844653, 1455810565, 101272872, 615028769, 2413043963, 3123051847,
  4275423401, 2051759280, 2722321442, 1547838979, 2778821297, 3224961372, 1272271931, 862065263,
  1839798790, 2907832106, 4231647312, 2772366052, 294132948, 2084892684, 766712315, 1815853673,
  471904668, 3324612435, 2046426575, 2816717766, 1636750191, 2286061247, 3361449050, 2389964511,
  2529616925, 398842024, 447646625, 1131175909, 3975265874, 3758543517, 2289246830, 2929751312,
  2105679457, 4119370899, 1482541138, 2653740597, 1613255642, 153170500, 223006312, 3495495611,
  1897409566, 537385169, 561754786, 3243487775, 804855480, 2991075416, 933268765, 1033076530,
  56292390, 3245457354, 1722562142, 1210624599, 3360781510, 2357582346, 3825672972, 2472902862,
  2442420516, 1794355738, 2228740890, 529875959, 2622795454, 4058463747, 3286421677, 2857005162,
  2351835626, 932906440, 1935974017, 3091729187, 1389395947, 2896743988, 1309758128, 2547598251,
  2530033670, 2581964883, 3182592787, 593333730, 3997240249, 3423322369, 2671962805, 265994553,
  813044899, 349433214, 695103874, 2086154435, 4293511631, 2651322767, 3625928979, 1888777525,
  1410588325, 4046438550, 1336206651, 3027342057, 773505559, 1913150010, 3420799188, 2522328521,
  467591449, 2384790779, 2444904001, 1289717544, 4123449348, 3038307348, 2599330656, 1288936032,
  973736949, 939741514, 2841863413, 403498113, 425393280, 3845840477, 2441892596, 1353692239,
  1796222253, 344291796, 2315675041, 72397257, 1778605013, 668966713, 4252529953, 1344363089,
  1999646280, 1386526401, 1106528988, 1896682832, 2851883019, 2840316244, 3519489094, 1018908055,
  3473658495, 2418162244, 3411379215, 1083512338, 1762642141, 1029026296, 3442922568, 2940576036,
  630087970, 3830392789, 1637961237, 79873623, 3381331253, 2898728516, 2327232736, 979306779,
  631331460, 1434526363, 609040804, 903110409, 4017279822, 85898280, 3880902209, 1022055602,
  2932391919, 2340152992, 3847833521, 2101502491, 902632466, 1503382043, 844525396, 1638697178,
  1875445261, 2963037127, 1614890319, 694370824, 1311994004, 3143804774, 1984082048, 4268773088,
  1190466558, 250090618, 805173963, 1966745984, 904571829, 372155626, 2286957529, 2192144388,
  1497879976, 3582234348, 3585706393, 2779512647, 2103010341, 1295320494, 2979851016, 3063319301,
  1666974239, 752593782, 79843205, 3372956028, 765862801, 3096895098, 780746287, 3469944397,
  968011624, 1181540882, 173391504, 446553565, 2974004482, 1975701347, 1298807851, 1552952835,
  724531129, 3070740574, 839679362, 316735945, 3800817563, 317676491, 1957584066, 1932988146,
  3509392728, 3105869430, 2905101186, 606931020, 2481595664, 3625702694, 1723812922, 445177932,
  3729848937, 3278142132, 2833072246, 2283439187, 3282965302, 1761543581, 2063333695, 4079340974,
  3493506757, 708836615, 248595512, 2093541257, 1058396178, 2289764263, 2871561722, 3273101158,
  269892488, 4231100726, 3929821865, 1901413971, 3371612754, 3255889312, 255583105, 3838608840,
  2819715566, 4265466105, 3977022020, 1990683123, 1986774456, 1128354599, 2097606408, 379854745,
  4209177193, 176561515, 2596280673, 175149292, 1524357563, 1692297343, 259677887, 1106580437,
  3032192009, 2294470179, 3981479610, 3482289302, 2156323634, 2153268636, 744101747, 2659766748,
  713989684, 4232889637, 767775520, 2550020491, 2428571392, 1265518188, 3530209546, 644621832,
  2200316602, 94227788, 1457615817, 2135450817, 2714296467, 824389308, 956610597, 2925972252,
  4018853401, 1387537451, 3302152452, 3959351683, 2873596863, 995848986, 398452529, 1087800058,
  4081569396, 92913369, 3610009848, 1189910526, 2016208337, 3707187136, 1000989147, 1137489172,
  571181401, 403107657, 1377539733, 1193683896, 1099631426, 2237255116, 739704363, 4151192334,
  1220665683, 1778974847, 470825323, 1607190073, 3836998998, 772605001, 2819959006, 1865410900,
  2884849368, 547595279, 1191817770, 2526613449, 1144986852, 4084842955, 4207270168, 1256867486,
  2314827170, 170336185, 1540891979, 824675646, 134112282, 1000943309, 2538592645, 3072141552,
  1866563228, 2865814458, 2282562000, 4163274210, 3264602186, 490547823, 3525521369, 1289232301,
  1168652836, 2874131663, 2575626334, 1529095798, 861355292, 2313925932, 1327486250, 603001518,
  3019637014, 3477053821, 779903481, 1910685579, 252805142, 3173574386, 3613523990, 2228912834,
  1730877984, 1218574121, 2327607840, 115981403, 3775766292, 2557055518, 2978126786, 496172184,
  494635291, 3131412202, 3074403492, 223468103, 1097119117, 3816962031, 2700374220, 2208143556,
  436653575, 2162032924, 614815869, 354928822, 3825552658, 3348681170, 78690343, 2725233161,
  3807648575, 2900953345, 2716103822, 1706610991, 8458824, 4092471330, 3738068341, 971116094,
  141668911, 2638250193, 899259939, 4046620614, 1315424669, 774039889, 3585189091, 3903264722,
  2053426442, 1663803931, 785151392, 2936265701, 1063725664, 1951493089, 1535599152, 3838340703,
  4096445344, 358903364, 1884170438, 2171374273, 1770436777, 2873804151, 3253290011, 2041989261,
  2009061429, 2961033281, 1527841555, 3798612980, 489802298, 3013220330, 281132032, 2125616054,
  2340613363, 2547345814, 2581843939, 463486199, 781197322, 3044189755, 2081408236, 1343101728,
  1987005102, 3805967871, 398610228, 1360573689, 1092065974, 4141564257, 3828651444, 1252213457,
  3762942543, 3886038038, 454825981, 3768411787, 3211543490, 1783605552, 3690694310, 2798446358,
  2488903310, 2286092106, 2308378005, 1636522842, 1250643852, 1868829748, 4056453785, 123938882,
  4138288869, 2284109689, 1817378350, 1968036351, 2056411710, 3516004768, 4021420121, 2580480864,
  3068137483, 1942432941, 3392151754, 1201868541, 126667331, 618814840, 1261845365, 20843360,
  1923185415, 1287189037, 1302816755, 2799893440, 3984165804, 616986167, 258215453, 3702285321,
  35730394, 1548579054, 1735157017, 2927852936, 3570750806, 2027141422, 805396496, 573696199,
  601903778, 3838672414, 3788442365, 244350488, 2221585930, 2331912937, 3572104624, 1074266890,
  459621531, 3091093492, 3086408875, 3154280137, 3777671365, 1262662203, 1927834170, 683702345,
  3618776045, 2066465076, 1066966788, 4036727102, 3491224315, 520603155, 3174025432, 3080946276,
  1534384853, 2457348566, 3847349553, 322562881, 2319757211, 2152141756, 2249250660, 919533098,
  4025754341, 3710041448, 2003271190, 885029230, 4120311626, 745282441, 3300388814, 3902794420,
  632293587, 3585848183, 3063194691, 1812806874, 2033299880, 877324338, 1689919671, 2003278207,
  782592569, 2010711540, 208967570, 2657400010, 3789290582, 1384802940, 2210777298, 3844022854,
  2092387030, 698960111, 3628854787, 1711591178, 2081580210, 3679837752, 2270520662, 1048705663,
  2443207092, 3493146542, 3681064249, 1598618905, 2158180677, 1833088194, 1989348272, 566447560,
  1221480463, 4235962422, 3124869475, 1920086913, 1866060904, 2647027522, 1993510594, 3171755757,
  1137446679, 1126660812, 3151568706, 522262351, 2766152035, 2623013192, 2727050548, 2239890900,
  1831461447, 349555513, 2263363849, 4188795047, 537119779, 1595552909, 388213877, 1633677048,
  3211879314, 1888686316, 2309765041, 2899939743, 3272179309, 2763893753, 687289183, 42081591,
  1671115821, 3596023896, 3911853272, 2029376565, 915999397, 227086589, 1960314767, 2469069849,
  3165679844, 2908200709, 2710935722, 728072443, 4288200924, 2517326932, 2316729995, 2436734425,
  331941177, 132073495, 4030010483, 163709744, 3430607312, 4110283220, 645134463, 2364581386,
  96186065, 417251325, 2853801287, 375900180, 1644500123, 1514296140, 2419390947, 2224219887,
  2427148043, 3747812229, 4092668677, 685266108, 1603686248, 3854696457, 3608195585, 2125950117,
  1309220104, 806065796, 3343193896, 11512751, 456214829, 2457636860, 1008560487, 2065027378,
  2770581860, 325989406, 1174700855, 542116089, 1279749956, 17271784, 1543530168, 2384698203,
  2490258009, 2044698517, 493621706, 1650054535, 943481458, 910579287, 1209026793, 3496235874,
  1000778992, 3308898969, 3385323565, 628877270, 1760778375, 3999061974, 2031356804, 963862964,
  3004272421, 957924140, 3639776906, 2458531968, 349295097, 2611026213, 2034319326, 1892003783,
  523177342, 3265697538, 4033382752, 359102779, 3751232569, 3482591508, 563727766, 4072896136,
  689427412, 3258719516, 2642300849, 3692999784, 2309981010, 1165505755, 2566420247, 2085696545,
  1630162287, 379860049, 1695277413, 3906822934, 1828193666, 1910515094, 4140663535, 473242655,
  1331780474, 2581175346, 3377981504, 1075540003, 2121232775, 823269646, 903162993, 2582190262,
  3192153802, 2680943561, 132780545, 1566680211, 3657443766, 2775593719, 595750013, 1704747456,
  4168006664, 2094194241, 75966748, 380537656, 2341050358, 3097483430, 2041042498, 2281291848,
  3725304773, 367400172, 4123638276, 2674197861, 3482737628, 282072251, 3558950326, 3971489878,
  3142773011, 644682038, 309185564, 23369926, 3949513394, 2745874071, 1546895052, 3440743762,
  3504029661, 3486183820, 2875764950, 1412640122, 28473416, 2589462181, 4220526172, 8123877,
  3799537252, 563554483, 3689793378, 2027623983, 3955022075, 3385255115, 1672881189, 4228720158,
  2460959624, 4182231148, 2465945447, 500677603, 147607780, 2305232856, 2686741796, 1048081076,
  2096912740, 4008663033, 118539976, 274882985, 2547145929, 678169954, 2164264355, 4182193571,
  3121041732, 831642769, 4063949235, 1742848117, 1539258062, 2675585976, 2969713743, 604577369,
  1500887203, 482326406, 1550420055, 1871381973, 2683043264, 3204019287, 3650223374, 2044140593,
  1182903768, 3871515812, 1611841547, 250607213, 2362978773, 2355051852, 2231664382, 725109802,
  3972190819, 3030278089, 3348097577, 1097797738, 2910466849, 1855273387, 2460644873, 923590585,
  189025459, 2161030604, 2877458587, 629364090, 133914744, 2632262787, 2226145875, 3696604657,
  3318027428, 2646548991, 1644549404, 3737384263, 1497325125, 3995890221, 1630307843, 2286734069,
  1641948996, 4102742739, 2958471985, 2177706432, 1049879552, 550552896, 166539534, 1178537688,
  2802136822, 837323890, 2457174238, 1730923294, 1503730498, 3541027207, 129058680, 862746995,
  572285890, 1255774893, 1205401908, 583505531, 2358280629, 1767615912, 4024933566, 3937273673,
  2157360818, 3733739729, 655177431, 1728538815, 544679663, 1586048280, 3500669293, 3532683485,
  2291688093, 1686311996, 1549657968, 3205249311, 2907062081, 1793399164, 3207791537, 1682692039,
  1910465396, 2231972070, 3308845645, 2564399177, 1913164949, 1369253597, 4165382815, 875214304,
  3736326087, 3560821754, 2683567733, 1779013977, 500758516, 1896448211, 1962054618, 398976444,
  3666346985, 2478006735, 2065843796, 312521677, 3650560629, 591093728, 1024362691, 3706451742,
  944859928, 141391936, 3611879286, 2019454840, 142540482, 1519190675, 3356381218, 3361909589,
  1493455725, 2515602534, 3694895869, 2563151542, 1191184075, 795279915, 3284145528, 3958592608,
  4100174210, 1181350536, 2848231292, 2286115491, 267786760, 3070952635, 4235913688, 2608749094,
  3740581920, 3797136069, 419118164, 3768503694, 3557533863, 4277125549, 1593040167, 1981222674,
  2594262895, 2687316150, 3816487541, 217186437, 2483358451, 1786464375, 1130060292, 2454516789,
  678911480, 63891314, 3185447937, 1896883820, 1319997621, 2616421139, 677865527, 3759502386,
  419971753, 2258718375, 1751382840, 305675064, 220804743, 1286524536, 2253200765, 2332043562,
  3627159735, 2652961364, 3185818797, 2161872844, 3883673926, 4273710722, 667539414, 2078094447,
  3952175941, 2073886695, 1274629997, 164620335, 3759937596, 2653547, 3465854721, 1327590509,
  4125705219, 4245986253, 3294550213, 2006246523, 2958238796, 2904717366, 771228668, 1677220671,
  1236920400, 3950677836, 1766212810, 2331847658, 2424366158, 3361146191, 2555413360, 3967021666,
  499418889, 675772853, 2406735605, 473656946, 3142929413, 1978207882, 998444247, 2621075574,
  3878814457, 1178449848, 3118910945, 3828335625, 2206737372, 857945312, 3339603293, 3513307642,
  847283214, 3489671444, 2251556855, 1286918593, 3485486195, 2282536917, 3041318078, 2362709497,
  993758025, 3160629693, 2910149875, 1592652605, 4018261099, 860238849, 1269851866, 2437785025,
  166259485, 421489405, 2123598434, 3966604528, 4294391538, 2227408046, 3559349687, 4126809006,
  1799599753, 2697125500, 3446422452, 3376854979, 392033490, 4162718028, 1329784238, 221041619,
  1727158514, 488865431, 2853185219, 753260855, 3725367111, 3557864361, 3483056056, 972174170,
  1252022808, 410090553, 1243531425, 3076503297, 1386814285, 1323096716, 421363173, 2813858448,
  3928160280, 1486808878, 502855403, 3115045487, 588986091, 766723314, 3634367512, 3717792870,
  3003768891, 1836511382, 1010024593, 2340365987, 3342802963, 2405937627, 3723642138, 2486392736,
  2535646764, 567825382, 3762805601, 3730037655, 2324697544, 2070517797, 578956211, 1349519317,
  1848790040, 4184823495, 69890892, 2811881597, 4201324610, 3772755524, 2184366828, 24697537,
  3219635397, 1061234736, 866994454, 1149666022, 3541771925, 1719626602, 1514764761, 3787380875,
  242946570, 2351803851, 3311365827, 2609156265, 2454089661, 32449509, 3970589316, 933422805,
  1463630842, 361163393, 2439714645, 2443178541, 1163238697, 2695527459, 460037855, 233125711,
  677037258, 2111451187, 146613272, 3074253024, 2831553548, 1962569313, 2751738653, 3496928876,
  2970120233, 3583547126, 3118373338, 3402359834, 1329838216, 453110260, 264815530, 3484793026,
  4202322647, 1846820193, 174504281, 3773777442, 3811096589, 2960127348, 2300321023, 502473799,
  1087432395, 1117217088, 2325166726, 2439575882, 2223815181, 306371468, 760290566, 487860685,
  3273260932, 3843201944, 99833761, 446958796, 1102916436, 1504601107, 2229912686, 62587764,
  3091522914, 10087485, 4115905545, 2255139394, 2692467509, 115409999, 304402757, 3161227181,
  11857202, 3342982782, 2153007358, 2508405512, 2846955531, 894586442, 618567013, 3178462060,
  2087645591, 3878416644, 233338416, 99197251, 1097216557, 1593396979, 2426490442, 4074464429,
  3848333586, 2532382578, 2127182048, 779729547, 3287949121, 1060251209, 2597290704, 265802637,
  1115335528, 3008681028, 4166185748, 3735048955, 1825435687, 1315436795, 3815746887, 148833912,
  2637822982, 2856153996, 73318183, 3800527341, 1474805960, 4035521698, 4234535251, 3981025014,
  4073140202, 2534522019, 594142049, 4137340732, 2300387843, 750562351, 4022679801, 2820645187,
  2045199418, 1756800817, 3773067861, 3886599801, 3271933085, 2953215231, 3506901550, 3831778922,
  4096529866, 702764075, 3595004385, 1906269267, 4187829542, 3226921091, 1174115726, 3361819463,
  385852645, 2109356, 3587710083, 962794949, 428401047, 3642294448, 3148056778, 1890460513,
  812696602, 2635549748, 2567398007, 897152584, 3725554689, 1275440339, 4019182554, 753055812,
  3416871339, 1686480051, 877690625, 4044464620, 1213239094, 4260901667, 2048818476, 3629912461,
  1019951034, 72592328, 1609969912, 2666712641, 1831803528, 411556409, 809205360, 3476213385,
  3781830562, 1976833527, 545907888, 2547009147, 1179613120, 2495210427, 1282007972, 2292678191,
  2008623215, 2210303794, 4037187981, 3960922421, 1106380044, 2400726925, 3588758669, 728226404,
  3620249452, 128276082, 3802158905, 510581405, 2735754461, 1109371416, 800609804, 4048092091,
  544138215, 847824780, 1175950342, 3162331670, 2161783630, 2877925796, 3352253378, 3080212483,
  2811413711, 1153446862, 3014471746, 3129799977, 705655200, 3510433659, 3951233382, 521927862,
  516457822, 1798283971, 2798954873, 2240034050, 2286668483, 4029203777, 913055996, 3858300832,
  52230804, 1450169257, 3364391039, 3475199093, 2348725327, 1719577235, 314618071, 3648512358,
  3302813756, 2123410114, 3987844596, 1590884237, 2662102304, 754211478, 672326043, 49543574,
  4037778669, 2523214936, 1997679196, 1741280763, 3690304032, 1143432745, 3641278667, 215299094,
  4068118436, 3048524843, 2480715966, 622780018, 848541701, 1662479671, 365343081, 1154546435,
  1703346134, 3027183127, 1743271836, 3131071152, 4102183944, 1121863253, 1155800444, 4176507301,
  3459813096, 603510359, 1624831890, 3474080076, 439455213, 3923068931, 2772773298, 3741484920,
  2206866691, 704049683, 1406498393, 1263840900, 922696161, 1380241148, 4017774372, 3923235389,
  2498989457, 4217385943, 3751375833, 1249771891, 399512791, 3305578540, 3575239389, 2527690156,
  182903275, 1181167989, 3159735866, 2521497267, 2212086584, 3956256856, 3821775571, 905469555,
  2298399968, 1445639879, 1600075046, 2081421647, 4180160546, 586289778, 1542755923, 373857212,
  2115342490, 2729184450, 1202926723, 772509783, 1968114185, 1826108289, 1327938845, 3979666294,
  885339330, 4097150129, 3543486946, 605468691, 4011178276, 1812210974, 3260751674, 4237161026,
  1579322052, 495864284, 2609512640, 2414120699, 1493556478, 2829511581, 2588976100, 315918846,
  3095699716, 1575468638, 1206778606, 1203888536, 801748220, 1023662088, 766890185, 1304502939,
  2139308702, 2579860669, 2179899898, 2891883987, 3692871039, 1614843138, 470066513, 4002046897,
  3012930286, 1969519242, 2356145300, 1533674223, 474427644, 576531300, 2368605898, 820490103,
  1310091344, 462761677, 852369256, 2557991808, 2338776268, 2115037337, 2382774723, 340034877,
  1413532142, 279671550, 2695625767, 909939288, 235410436, 403283740, 3039678314, 3914543597,
  1982560646, 677818655, 3273125676, 932553859, 1987460130, 3315095428, 2895085444, 3597655550,
  1322733472, 2916135459, 2196941932, 3736954121, 1176370753, 935498672, 3452702922, 3814948987,
  3020234257, 1126767837, 3747639323, 839091421, 3146349292, 1078091113, 2810397147, 4000919974,
  1095982312, 1386526375, 135465068, 177014022, 2005678144, 189244753, 1068641318, 1339102830,
  205567324, 2659221082, 246332718, 1983645760, 91867856, 228442709, 2409608563, 563596076,
  760550169, 3812029582, 2454153543, 511859744, 1630566427, 578901897, 2431936985, 1095589091,
  144983175, 1708658599, 3959769807, 125412631, 3145949129, 1287893120, 793732945, 2611190041,
  2986875525, 1090039721, 3218801153, 690138373, 21335127, 3562086318, 2021015040, 2618780187,
  2154095969, 391201456, 2754399343, 277976450, 3984986640, 3039333899, 1091911686, 1035782200,
  2298309560, 1566303175, 113317052, 4064943909, 1283015398, 267245527, 3767850910, 3173636234,
  566848259, 1300407607, 427043988, 3569121848, 705701677, 3231584812, 1952078836, 1167424977,
  10879177, 3556020500, 1336292279, 3460408829, 3358106497, 3928614582, 3883099366, 219144659,
  760813550, 1667203, 2741856417, 1829531257, 3015712041, 2052293250, 2102011090, 2625087508,
  2972830608, 1448341987, 756167608, 1057797389, 3610747842, 3946467286, 2453694885, 2922845667,
  2857999307, 3921269847, 501628542, 738129532, 1505908070, 1073727634, 3702778225, 2929556071,
  2590581960, 3020367808, 1992847654, 1696584261, 4074690383, 36486211, 1976895868, 300605771,
  2647432960, 390441096, 3122852618, 3181271299, 1513744662, 1315163847, 3038209940, 303264950,
  971984388, 925844648, 1494490417, 3007303959, 303686803, 167283983, 2767343925, 2542537369,
  682531304, 1252914061, 2107867573, 1412615335, 1326509252, 3685752022, 3827292770, 4105380665,
  3969888986, 3426030599, 849277144, 392631502, 1004991929, 1802071046, 1587259187, 1339838986,
  4171262916, 1789960070, 3657583158, 3906822710, 1907374605, 1429096682, 342537152, 161223183,
  613755610, 216652420, 1767688687, 3232199007, 979843152, 2867471437, 2380821109, 3018284721,
  1464584555, 2791389935, 2621913557, 2703273778, 2585338273, 232451686, 3400037658, 2071912163,
  3847309447, 2668471652, 1944586123, 1059463407, 973197184, 2463143147, 719178961, 1549021916,
  3384756675, 3306961778, 2412183550, 1569690224, 2778125502, 630535845, 1589769004, 499136001,
  2981951616, 2994916585, 1208087795, 538473060, 776949987, 166730646, 2690889925, 1349594818,
  2749912726, 2253422666, 3453277975, 926182740, 4151128302, 3349193067, 4096210001, 310418047,
  3592431648, 231507631, 1775857626, 1342327163, 1770174302, 33919285, 2984899441, 3603335833,
  1087787013, 211644054, 3129467426, 3427899248, 2216294691, 995444307, 1178055876, 2760127897,
  1348935951, 2504511859, 1605526709, 3830458935, 3663026405, 323215052, 407814232, 2191793709,
  532427236, 3416472418, 49808296, 3368934162, 144167462, 3217524742, 425538971, 1219254342,
  1229803273, 3508575251, 2824426305, 720939671, 1770188653, 4054260012, 3947226700, 2646637342,
  4157940743, 3974639481, 3003650172, 2192650860, 3442615068, 508663806, 4246635101, 931357327,
  2998395581, 1377940038, 4248527116, 1765907482, 1738793218, 568966222, 460415539, 1193878185,
  294630116, 2999192025, 677825094, 1438952288, 3040544328, 1994212237, 193261773, 1331537322,
  85614967, 529577625, 2996405618, 4194046451, 1158537875, 248870456, 3274537839, 2917533898,
  3170375924, 2148236501, 3840124133, 80235086, 3723632557, 620720173, 2133060996, 3742233230,
  3500026326, 301162349, 779643967, 2815963300, 3367205373, 1305437580, 681701074, 3972294374,
  3929962163, 717513873, 3152704131, 2913027068, 4252554732, 892217777, 2838552021, 681149681,
  3328886829, 3275442173, 1029104089, 391736985, 1982085059, 1629093911, 3746555806, 136452052,
  1523711439, 1525882378, 2620453160, 3209739771, 3842695032, 4213502606, 3601810086, 121935266,
  3385703659, 471593065, 1583931452, 2185764321, 539015121, 1129280519, 30637097, 3229250561,
  122569280, 1681342652, 3918230772, 2872681686, 3230065449, 2038086273, 1848293658, 3710936135,
  3044033347, 2285937498, 3732224952, 2227756818, 3069838372, 98981159, 2122042679, 2062292460,
  1640249627, 366255434, 923233267, 3561620173, 743083414, 1725667680, 3939087537, 2895843148,
  3026981306, 3912155908, 2022798828, 217645541, 2778755674, 1333617276, 3315156129, 2453335307,
  1685191754, 4082753232, 4155885626, 41476669, 2736898345, 3506550604, 1359085808, 4174762284,
  1567182627, 608721194, 2045532185, 633905464, 1408448566, 2092808567, 665238668, 807530900,
  1566561792, 3398989192, 3019028777, 2979393477, 4179673570, 452168582, 2486157925, 3532089140,
  3488721582, 861707699, 2637475353, 1761988628, 707258577, 3425123109, 2715011558, 1433955782,
  2512835162, 2561560119, 3896675281, 231959053, 1490826659, 3256145296, 1596161622, 4075991210,
  3300741529, 1363034670, 1246960033, 1032555486, 3135493034, 1687691967, 1562841048, 3064835765,
  2031612482, 752647363, 3976208600, 923180868, 73921810, 1058163413, 85393731, 2439642413,
  1888275286, 4218573851, 1316141494, 3970871004, 3966434454, 3111677648, 634724555, 2406519728,
  1151511294, 997634434, 4234909103, 695975601, 2285567669, 2188591568, 2691334859, 3542267288,
  1701413555, 391925313, 2544733922, 342693902, 3172537926, 3323515948, 1222088355, 1094004286,
  1463573328, 1813850441, 4067928149, 10005808, 575766809, 2166123052, 1998845465, 2020335360,
  4058267024, 1673940154, 3074867394, 1065318649, 1457191775, 4109136193, 548084773, 4126797675,
  1006951666, 3272227463, 1892647409, 1936464129, 3869819967, 1385631115, 1412895300, 537522925,
  2611162329, 1172517282, 330526324, 3440508003, 3326408205, 2999137197, 3731229881, 2288302510,
  4158870481, 3112672985, 2495505661, 998836952, 3771592747, 2032398624, 2084267071, 3035064348,
  577034735, 799481998, 1033139877, 3199969367, 4220351226, 2336983543, 1494226268, 1208420106,
  972006595, 758151834, 4131942979, 993609799, 1964200830, 2197802007, 2568658337, 1938656020,
  2802752403, 882162824, 3406219265, 1830236943, 4016001371, 1197705830, 2701938505, 1964232499,
  1410469281, 2955169876, 1617086371, 2542738502, 4088659424, 287614930, 2679943909, 2270645788,
  3881620126, 2221621510, 3051892972, 2406571060, 1828811499, 623163921, 3021930784, 3590549158,
  15435414, 1158827641, 3438981999, 1543992681, 2788203447, 1279521989, 3165870575, 1972853772,
  3197002624, 956680125, 278500390, 2176015667, 3331881669, 4075977911, 2852856318, 2139564353,
  3325233692, 1259200334, 400580704, 662959407, 3127287782, 1056910724, 3569500762, 425453132,
  2456844108, 3436956889, 61678279, 1378850976, 226540551, 15665664, 2758048894, 1545879478,
  50523107, 2991152573, 3917612471, 3147171825, 119995575, 716890400, 3037987868, 3383221658,
  1790519863, 3755605533, 2484358102, 2520253747, 594308429, 942655164, 3345795044, 497684168,
  866133694, 274597318, 1960829927, 3380343364, 807168754, 2248136491, 1265071140, 3660312886,
  1326783316, 17160908, 3507589706, 244193740, 2261269594, 1742429336, 3388174911, 2170742122,
  749953855, 3126367758, 580490642, 3336765446, 621782469, 2302306071, 1401239832, 3720553275,
  710534415, 811439474, 720407977, 666458249, 2640195981, 582364796, 936584660, 3657332822,
  3566574253, 3516210804, 3912431585, 2198498839, 3784010181, 2584967941, 2035437826, 4079486126,
  204327985, 538428132, 682549303, 4195648394, 1889938152, 2541661330, 119537968, 981690493,
  394338536, 1758241438, 2706734146, 2085650197, 3076863762, 167005120, 3034219885, 2704375548,
  372102213, 2807501748, 1098636699, 4227522836, 520578219, 1112469625, 1473475826, 4209471679,
  1084484734, 2625356299, 3954212321, 110551388, 2305512912, 2559577380, 1086944727, 2741222399,
  597493030, 3353393222, 428568934, 2438234874, 1408749336, 3437505052, 2093515109, 3589913605,
  3926048070, 927165122, 754817463, 180718498, 2193330530, 1352911993, 1048264712, 2796569327,
  4254184587, 803840037, 20772681, 1090588406, 2980573389, 2249249582, 1605789072, 3438716019,
  3549147320, 1011690014, 372365502, 2410743875, 4245496182, 4118898209, 100708326, 330726848,
  2673457213, 3470808272, 2691563548, 3228631980, 355228774, 1748253792, 120874161, 300502169,
  2704518818, 2867618134, 857113425, 245853659, 1574670983, 819212406, 2747700700, 3580179217,
  1341886016, 3854660636, 2059287478, 2761579351, 3287129599, 3121704732, 3074279632, 1575468109,
  100067208, 644864307, 3506983370, 1577762958, 3065542649, 728776974, 4174356696, 2283863558,
  2147599268, 2445392076, 768799248, 2834072719, 2109862294, 2609556196, 3911325149, 3462862203,
  1314515096, 679587218, 3326485638, 458877350, 1306702561, 378555883, 112889018, 3229274979,
  2980255245, 1169612524, 3332561946, 2546244802, 399679476, 1451984235, 2645432501, 4229962638,
  1098273334, 3033577884, 1085603916, 4165964615, 1934358539, 1559480361, 3049142584, 3477305627,
  3977998164, 579697630, 1304309689, 4175390256, 771980772, 2101773540, 4004431502, 2068697752,
  4222052768, 1816669854, 988809227, 605256879, 552513007, 46059378, 339464441, 3574712493,
  610668458, 1545242317, 1387571118, 2608045944, 2729652990, 4047661581, 2693769913, 2414526549,
  1077435854, 244301481, 271518472, 1988174120, 2738305370, 3278914097, 98457388, 3640780046,
  1591554277, 514310403, 3341001397, 1074815958, 637105202, 2843869132, 2435560016, 547566780,
  906831698, 2651458217, 3537785177, 1903518018, 3274563632, 1473480230, 2318218863, 3453001856,
  3305428285, 87556952, 140554379, 601112304, 673074186, 3090442829, 49357065, 2785755177,
  514304715, 896490727, 4232281732, 1275090827, 891843070, 3183709545, 1860976567, 1186539373,
  3886555984, 659089231, 1116104292, 2448334507, 123841162, 1130577191, 3449891608, 3024576083,
  2605753792, 974880368, 892193167, 3806479637, 3787532984, 514254363, 960342054, 106149257,
  1789648435, 2324005647, 347471892, 271696040, 1955588141, 2825118655, 2239938855, 1664962085,
  617870028, 3935693216, 1774819665, 2458681441, 638856379, 2758569541, 3625395905, 3848767190,
  1464242808, 2729632487, 1710112935, 795733275, 597161769, 2980811146, 579773895, 2924440129,
  3878652567, 1795044338, 2231187526, 4149216386, 3117263139, 2790719839, 1682137755, 2188114279,
  384933932, 3347055577, 3193732583, 1768242451, 3501002998, 1223437229, 1253142110, 1619225660,
  2969525287, 861689872, 3785758162, 3038780106, 454017524, 297847374, 2800974885, 2515359550,
  1276127880, 1104944441, 2042341920, 2910434837, 396294116, 107958629, 3791090099, 1100456332,
  1273717880, 3120986855, 3062409346, 1623865331, 2650519916, 231958006, 4118744084, 3586164015,
  2341905800, 990056791, 979942521, 532930580, 4039286655, 1524631953, 4125941153, 2359178641,
  675983008, 3325692018, 3376402413, 910037384, 3279855392, 2424921492, 3492100988, 474887507,
  317425556, 1388908376, 877187696, 1674992720, 3356155854, 662204984, 3258672288, 3429049752,
  3886192053, 3368998525, 3218682904, 2799275656, 1527370726, 3765313687, 4025799077, 624779593,
  2376900231, 2307611110, 1728139505, 3562668433, 1046071775, 1703559011, 3449976475, 3190096000,
  4167310894, 3640849851, 3655729578, 729577548, 183532461, 3098800633, 2559781110, 393398041,
  2350981950, 40647426, 2851100693, 711740109, 2778846707, 2217051586, 1737185179, 1221654640,
  151818516, 2375003484, 2371419635, 1290729841, 539158543, 3009904834, 3475107231, 3410679843,
  1753023186, 3439801489, 2333993455, 322143128, 2642078486, 2938975328, 2020754588, 1031630339,
  3889281888, 3509593684, 1904520217, 1680044343, 1994640014, 4066076867, 2085323502, 405302412,
  2770373927, 2903065564, 2015791996, 655998612, 1532382347, 207007723, 3218391827, 2469734028,
  3907043032, 4116041676, 500205587, 3195752175, 2249924127, 1356437480, 2260649718, 3023781597,
  972634647, 983566510, 1691363621, 292016419, 1846913482, 1833727149, 408174349, 3904653234,
  508456279, 886474593, 4160514085, 3919282023, 1124349331, 3430191274, 441749792, 2489348614,
  3964190698, 1473832757, 2183561815, 3885329265, 1520098147, 2539995289, 4271576112, 1561058108,
  142900522, 2456597430, 419275069, 3592410342, 2607804635, 35880431, 1052500043, 1902923533,
  371041055, 2698579807, 1312049250, 942897493, 1414328445, 2289875018, 2327832143, 3133050891,
  758812458, 1172895618, 805986399, 342953285, 742626997, 3422654561, 2905639703, 1747132252,
  3263067207, 2554817601, 1350526536, 1292216023, 1540456720, 416582442, 100114006, 3636357495,
  2027043656, 125710784, 2850215101, 3051846458, 3140519841, 1210991242, 2208581572, 2595070597,
  2164647132, 319386804, 2031580624, 692404289, 1670592005, 205014765, 2591499269, 354961763,
  2612538143, 2407679472, 151613542, 372297038, 1917368567, 1482590358, 4045536913, 789438159,
  1230283715, 3876734701, 2174363988, 2330740593, 3862968013, 2067067488, 3787760658, 3432245109,
  3573923613, 805488471, 2767868709, 1635362717, 454853199, 2900410190, 2789767624, 2788667250,
  1082684626, 1101992385, 181328568, 740043994, 3421892481, 2608091309, 376542057, 3109472185,
  2339682392, 986762536, 2074042966, 2639564850, 3338790682, 3586771765, 3293097469, 4069069153,
  1499897939, 3309711960, 925615695, 2708867531, 1391880042, 1456492725, 4111224512, 472986832,
  1845720581, 367777678, 262540146, 2903904653, 104072855, 3878590781, 2806130650, 3363835776,
  899568170, 681419743, 3063238948, 2980111497, 2420458565, 1250840716, 3614736670, 3195450033,
  2973120722, 4014693252, 744281762, 2707926528, 530806899, 1698259981, 3367778027, 1292472823,
  435992206, 666995698, 1385861031, 2625656607, 1037561177, 3586069439, 688830530, 1260572826,
  36526189, 754299746, 2648684552, 3621570120, 2325396866, 2850179073, 4157134865, 1971110890,
  2259699469, 1829216678, 834728963, 122160534, 260162616, 41834461, 960169, 132945692, 3627005569,
  3813684300, 726779280, 2262668429, 1692223341, 2265474273, 3286111236, 1492300834, 1756942612,
  1372373631, 1220484694, 1441699729, 1290301506, 2482361670, 3545917492, 737708309, 2608496982,
  1238695667, 4251068696, 2236156953, 3329972699, 3243595363, 3091886742, 3454523720, 118660212,
  2520616806, 355395178, 16341004, 551366015, 2463481211, 4380831, 1028404773, 3847985974,
  741809186, 669796344, 3580249281, 2234695920, 96475267, 2334039490, 1612638643, 3036322640,
  1477586260, 597525569, 2721765118, 239066494, 3380540931, 3249322135, 95511089, 3555549980,
  945590580, 1162620541, 4059303613, 300031315, 1691379864, 1549548566, 240593342, 2050901074,
  1309534312, 51948003, 1832698676, 1384714860, 3624687298, 68597890, 2997539260, 3301158670,
  3027658903, 1311968036, 3108901969, 1141107071, 712494192, 3586226146, 2173882259, 4147855511,
  1566370085, 3769971261, 571557884, 3610790303, 3491161441, 2577469741, 3042599589, 1592327858,
  2669632637, 1715457162, 1718419948, 1218922771, 3602768491, 1873281841, 3719569815, 1065363216,
  2685904429, 3775887535, 3538831405, 1959132548, 2991705421, 1548890905, 587527090, 1793205543,
  597403826, 2056822457, 2556828633, 63822532, 1472264473, 3728809432, 103751451, 1511456369,
  2699430952, 4155081654, 3713489082, 2878946823, 1957695769, 553768712, 875119945, 3394031897,
  1402002429, 4098680148, 2361588001, 2925379291, 2560394744, 3582124150, 2350658942, 205025701,
  385979822, 1352559325, 2925803968, 3792467230, 1139576849, 58413286, 31872938, 3324893565,
  2434106691, 1412507729, 1656777958, 1301213736, 4201558708, 3205021813, 464771249, 681642985,
  2665693582, 450984928, 2609642690, 2957036831, 1940076634, 3372931848, 2133272833, 1567299433,
  3229987407, 160349854, 2458885931, 3643472971, 3796026602, 190122383, 1430524547, 3235721398,
  1618884630, 1788119650, 279068949, 2945529204, 263554788, 2309095005, 191609849, 855769484,
  3661890727, 397383866, 4279473329, 2042832793, 1978087090, 2289416334, 2990954375, 552552626,
  3343317556, 328452312, 2024770560, 47908360, 1676780017, 3771803002, 1332177510, 1822314212,
  3548527225, 2032171710, 2289905821, 2215132746, 572825547, 1431306867, 1541894144, 102115074,
  2140117514, 231667526, 4148695022, 3207254328, 2456441231, 3128747749, 2446490891, 2198149790,
  3249670307, 1231001096, 2452933696, 262850122, 3918425355, 2098987960, 3186928788, 1946205533,
  1908249182, 2912609309, 3917735884, 579915267, 193108037, 4051090834, 2945269105, 902720018,
  3716212465, 176424347, 930693137, 3816875422, 622479216, 2705612884, 267675451, 543593670,
  4164467834, 212773110, 2628912377, 2283142524, 3539390785, 1091003301, 3688797290, 690247032,
  2713745346, 3908681368, 1457827216, 3111292494, 2693436090, 1158631507, 3308120412, 4118073091,
  1702869030, 3978071391, 3203691306, 842071082, 1637847792, 1084569361, 4576331, 2658045014,
  495016851, 727028122, 3044308812, 2279850762, 913475278, 85981688, 2728568129, 2810511656,
  3627134579, 2030422087, 755833844, 1960719555, 987155455, 4257084560, 1208559119, 2140232382,
  4261618306, 2002597172, 1144663956, 3373303344, 2327016252, 3372831107, 1426270388, 3952797190,
  1030702392, 170496785, 2486047434, 3895490094, 3833758249, 2491776503, 703170498, 3654240992,
  3196282297, 959170224, 2673135215, 1216749321, 160341719, 1384053313, 3422331538, 734508224,
  1133855113, 2091296817, 612736290, 2011289616, 1021036824, 3558395573, 1583541292, 2702350114,
  1643279635, 703455809, 1353741104, 1348356484, 533656663, 314718382, 1440742134, 129242304,
  2546179765, 408837862, 293141312, 3110348112, 3752710816, 3913038835, 1735454198, 3184508277,
  1411631353, 4248831041, 1557992190, 3984528866, 1547029290, 1202432156, 4189681436, 2049359884,
  1420202476, 1650590077, 827541148, 1730510456, 1269119473, 491915499, 1725444382, 3916662079,
  475005701, 1097102860, 2631406636, 3232382486, 828284210, 3556942273, 778180029, 1078506044,
  3447761903, 3799618893, 1564704906, 3929899611, 2504357079, 4262351208, 2254313558, 2046399540,
  571238142, 1071319657, 3056159849, 2688865645, 551602245, 311686034, 578439196, 633880931,
  2660505622, 2895117715, 29430634, 1169496995, 1884502366, 2265652391, 1480598638, 949144002,
  2297985856, 1767476098, 2741169560, 353017946, 3905165155, 4260195370, 1982545073, 2874227975,
  3229252535, 1416016550, 3118478507, 863954264, 594586246, 3366087595, 366931864, 49035807,
  1582238280, 1680028851, 1076608569, 3982630646, 141134713, 2406615992, 1517885287, 4131085860,
  2516753191, 175977940, 4170111760, 579244210, 1116726334, 2036637505, 4008322600, 2155340293,
  1752591377, 763775544, 173179826, 208859663, 639112289, 2551424432, 3931810521, 2474252372,
  3725768661, 1730883589, 4127975791, 4121859064, 1799298964, 1135798110, 3356868969, 905733778,
  447603120, 1677819752, 3261833820, 376681156, 1616356405, 3573409724, 1477564575, 2748476822,
  3791797533, 2183454569, 1966024152, 1882722154, 1977765477, 3685343632, 3056715212, 2601612771,
  1915811864, 613266829, 2080569030, 3508799000, 2427847623, 2626395548, 3279965337, 3933214107,
  2439547932, 182079501, 280914129, 884166282, 398794576, 2322066632, 3008500789, 478072000,
  4152630501, 1261740389, 2220083633, 306961901, 728176980, 2385002017, 1918923621, 3731656873,
  3908464770, 3093685631, 589436792, 1992363097, 3683924489, 2270207836, 1813670343, 318833337,
  4007038925, 1389929044, 1433582120, 2435255244, 3926804055, 26876049, 2624535654, 3847991089,
  1263763562, 2810736035, 1091348117, 2560994029, 3313091845, 1233274292, 3173059671, 3507852055,
  568614819, 2842842250, 3526990439, 956316764, 1402501694, 1729891432, 854873982, 1395201672,
  437671704, 590956474, 160491386, 3232833891, 1530942733, 3582780093, 2172550020, 3914170626,
  705057086, 3781559541, 1042949395, 3835267834, 2320884214, 2411336918, 4040770316, 316306914,
  471202722, 2153488769, 347826302, 1198427399, 1218688468, 1775201161, 422222376, 3353248066,
  2013277268, 1611089701, 3289156994, 3306215224, 3635278080, 566075265, 3847527379, 3509346698,
  3087559791, 3511997695, 295271530, 2292849687, 3700112001, 1551454699, 297497919, 1973853011,
  666557556, 2198048606, 3004870142, 1484890406, 3998034803, 1951616440, 548325562, 3252579516,
  2015041418, 3347555817, 5571574, 2426154819, 2939430669, 1725000655, 993973651, 1752778996,
  1473125758, 906739796, 3542154705, 144990187, 2474342250, 3614402906, 1277049193, 341938479,
  2708606726, 2141514284, 3020845508, 321629088, 2199124182, 1731311104, 1384406241, 1164146372,
  844354202, 3216862942, 745942366, 3105229076, 1935447059, 1483470101, 1687654010, 2650162905,
  1547835402, 879320815, 2027444680, 1198403552, 2117904172, 67746938, 303789835, 2865545981,
  2347637332, 3354110350, 1899666792, 3714026483, 3755246005, 3797700315, 4222970866, 3893319527,
  793441842, 2974701734, 2443338240, 2691832361, 3317326455, 4239682477, 2251871403, 890600080,
  1776865165, 4206166977, 640005793, 437390376, 356009464, 3397650252, 515847825, 3829567248,
  1308438831, 597384519, 1418324028, 3183764503, 3151785927, 2116455217, 3678975815, 250139030,
  2742992386, 498432187, 3483074737, 3328051007, 1550094487, 666868056, 307815277, 4280644765,
  3880464020, 2864145237, 531683017, 2176811171, 3514743737,
])

/**
 * Minimal Bloom filter implementation (no dependencies!)
 * Based on bloomfilter.js by Jason Davies (BSD-3-Clause)
 * Uses same hash function as bloomfilter npm package for compatibility
 *
 * The BLOOM_BUCKETS array must have exactly Math.ceil(BLOOM_SIZE / 32) elements
 * because each Int32Array element stores 32 bits.
 * For BLOOM_SIZE = 120,000: we need 3,750 elements (120,000 / 32 = 3,750)
 */
class BloomFilter {
  constructor(
    private buckets: Int32Array,
    private size: number,
    private k: number
  ) {
    // Validate bucket array length matches size requirements
    const expectedLength: number = Math.ceil(size / 32)
    /* v8 ignore next 5 */
    if (buckets.length !== expectedLength) {
      throw new Error(
        `Invalid Bloom filter: expected ${expectedLength} buckets for size ${size}, got ${buckets.length}`
      )
    }
  }

  // FNV-1a 64-bit hash with enhanced double hashing
  // Adapted from bloomfilter.js by Jason Davies
  private locations(v: string): number[] {
    const k: number = this.k
    const m: number = this.size
    const r: number[] = []
    let a: number
    let b: number

    // FNV-1a hash (64-bit)
    const fnv64PrimeX: number = 0x01b3
    const l: number = v.length
    let t0: number = 0,
      t1: number = 0,
      t2: number = 0,
      t3: number = 0
    let v0: number = 0x2325,
      v1: number = 0x8422,
      v2: number = 0x9ce4,
      v3: number = 0xcbf2

    for (let i: number = 0; i < l; ++i) {
      v0 ^= v.charCodeAt(i)
      t0 = v0 * fnv64PrimeX
      t1 = v1 * fnv64PrimeX
      t2 = v2 * fnv64PrimeX
      t3 = v3 * fnv64PrimeX
      t2 += v0 << 8
      t3 += v1 << 8
      t1 += t0 >>> 16
      v0 = t0 & 0xffff
      t2 += t1 >>> 16
      v1 = t1 & 0xffff
      v3 = (t3 + (t2 >>> 16)) & 0xffff
      v2 = t2 & 0xffff
    }

    a = (v3 << 16) | v2
    b = (v1 << 16) | v0

    a = a % m
    if (a < 0) a += m
    b = b % m
    if (b < 0) b += m

    // Enhanced double hashing
    r[0] = a
    for (let i: number = 1; i < k; ++i) {
      a = (a + b) % m
      b = (b + i) % m
      r[i] = a
    }
    return r
  }

  test(value: string): boolean {
    const l: number[] = this.locations(value)
    for (let i: number = 0; i < this.k; ++i) {
      // locations() always returns an array of length k, so l[i] is always defined
      const b: number = l[i] as number
      const bucketIndex: number = b >> 5
      const bucket: number | undefined = this.buckets[bucketIndex]
      if (bucket === undefined || (bucket & (1 << (b & 0x1f))) === 0) {
        return false
      }
    }
    return true
  }
}

// Initialize the bloom filter
const bloomFilter: BloomFilter = new BloomFilter(BLOOM_BUCKETS, BLOOM_SIZE, BLOOM_HASH_COUNT)

/**
 * Validates that password is not in the common password list (top 10k)
 *
 * Uses a Bloom filter for space-efficient checking.
 *
 * Performance: O(k) where k=8 hash operations
 * Bundle impact: ~3KB gzipped (15x smaller than full list)
 *
 * Trade-off: ~0.5% chance of false positives (incorrectly rejecting a strong password).
 * This is acceptable as users can simply choose a different strong password.
 *
 * @param password - Password to validate
 * @param options - Validation options containing checkCommonPasswords flag
 * @returns Validator check result
 */
export const validateCommonPassword: Validator = (
  password: string,
  options: ValidatorOptions = {}
) => {
  const { checkCommonPasswords = true }: { checkCommonPasswords?: boolean } = options

  if (!checkCommonPasswords || password.length === 0) {
    return { passed: true }
  }

  // Case-insensitive check using bloom filter
  if (bloomFilter.test(password.toLowerCase())) {
    return {
      passed: false,
      message: 'Password is too common and easily guessable',
    }
  }

  return {
    passed: true,
  }
}
